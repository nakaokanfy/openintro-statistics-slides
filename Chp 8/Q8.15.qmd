# 8.15

男性が次の条件の女性と結婚しているとき、夫と妻の年齢の相関はどうなるだろうか。

> (a) 3歳年下の場合。

夫の年齢をH、妻の年齢をWとすると、夫の年齢は妻の年齢より3歳年上です。したがって、一次関数として表すと以下のようになります。

$$ H = W + 3 $$

この場合、夫の年齢と妻の年齢の間には完全な一次関係があり、相関係数は1になります。

> (b) 2歳年上の場合。

夫の年齢をH、妻の年齢をWとすると、夫の年齢は妻の年齢より2歳年上です。したがって、一次関数として表すと以下のようになります。

$$ H = W - 2 $$

この場合も、夫の年齢と妻の年齢の間には完全な一次関係があり、相関係数は1になります。

> (c) 年齢が半分の場合。

夫の年齢をH、妻の年齢をWとすると、夫の年齢は妻の年齢の2倍です。したがって、一次関数として表すと以下のようになります。

$$ H = 2W $$

この場合も、夫の年齢と妻の年齢の間には完全な一次関係があり、相関係数は1になります。

これらの関係を確認するために、模擬データセットを作成し、散布図を描画することができます。例えば、26歳、27歳、28歳、29歳、30歳の女性5人を作り、各パートの各妻の夫の年齢を求め、散布図を作成します。

```{r}
# 女性の年齢を定義
female_ages <- c(26, 27, 28, 29, 30)

# (a) 年齢H = 年齢W + 3
male_ages_a <- female_ages + 3

# (b) 年齢H = 年齢W - 2
male_ages_b <- female_ages - 2

# (c) 年齢H = 2 × 年齢W
male_ages_c <- 2 * female_ages

# 散布図を描画
par(mfrow = c(1, 3)) # 1行3列のプロットレイアウト

# 日本語フォントの設定
par(family = "HiraginoSans-W3")

# (a) の散布図
plot(female_ages, male_ages_a, main = "(a) H = W + 3", xlab = "妻の年齢 (W)", ylab = "夫の年齢 (H)", pch = 19, col = "blue")

# (b) の散布図
plot(female_ages, male_ages_b, main = "(b) H = W - 2", xlab = "妻の年齢 (W)", ylab = "夫の年齢 (H)", pch = 19, col = "green")

# (c) の散布図
plot(female_ages, male_ages_c, main = "(c) H = 2 × W", xlab = "妻の年齢 (W)", ylab = "夫の年齢 (H)", pch = 19, col = "red")
```